#!/usr/bin/perl
if( $ARGV[0] eq '-h' || $ARGV[0] eq '-help' || $ARGV[0] eq '--help')
{
help();
exit;
}
sub help {
    print "\n=== pqs_extract_xyz - PQS Coordinate Extraction ===\n\n";
    print "PURPOSE:\n";
    print "  Extract coordinates from PQS output files.\n";
    print "  Parses PQS coordinate sections for geometry analysis.\n\n";
    print "USAGE:\n";
    print "  pqs_extract_xyz PQS_output\n";
    print "  pqs_extract_xyz calculation.out > coordinates.xyz\n\n";
    print "PARAMETERS:\n";
    print "  PQS_output - PQS output files with coordinate information\n\n";
    print "INPUT:\n";
    print "  - PQS output files with coordinate information\n";
    print "  - Must contain 'Coordinates' section\n\n";
    print "OUTPUT:\n";
    print "  - Coordinates written to stdout\n";
    print "  - Format: processed coordinate lines from PQS output\n\n";
    print "DETAILS:\n";
    print "  - Searches for 'Coordinates' keyword in PQS output\n";
    print "  - Skips header lines in coordinate section\n";
    print "  - Processes coordinate lines until 'Point' keyword\n";
    print "  - Strips first 6 characters from each coordinate line\n";
    print "  - Useful for extracting geometries from PQS calculations\n\n";
    print "PQS COORDINATE FORMAT:\n";
    print "  - PQS uses specific formatting for coordinate output\n";
    print "  - Coordinates appear after 'Coordinates' keyword\n";
    print "  - Each atom's coordinates on separate lines\n";
    print "  - Section ends with 'Point' line\n\n";
    print "EXAMPLES:\n";
    print "  pqs_extract_xyz calculation.out > coordinates.xyz\n";
    print "  pqs_extract_xyz opt.out | ref_gen_step1_cord molinfo > system.ref\n\n";
    print "TYPICAL WORKFLOW:\n";
    print "  1. Run PQS calculation: pqs < input.inp > output.out\n";
    print "  2. Extract coordinates: pqs_extract_xyz output.out > coords.xyz\n";
    print "  3. Use for further analysis or .ref file generation\n\n";
    print "SEE ALSO:\n";
    print "  pqs_extract_frc    - Extract forces from PQS output\n";
    print "  ref_gen_step1_cord - Generate .ref files from coordinates\n\n";
}

while(<>)
{
if (/Coordinates/)
{$_=<>;$_=<>;$_=<>;
while(<>) {
 print substr $_,6 unless (/Point/);
 last if (/Point/);
}
}
}




